{"remainingRequest":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\src\\components\\table\\advance\\ActionColumns.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\src\\components\\table\\advance\\ActionColumns.vue","mtime":1637637094000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\babel.config.js","mtime":1637637094000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkM6L1VzZXJzL21heHpoL09uZURyaXZlL1x1Njg0Q1x1OTc2Mi92dWUtYW50ZC1hZG1pbi1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuZml4ZWQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBjbG9uZURlZXAgZnJvbSAnbG9kYXNoLmNsb25lZGVlcCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQWN0aW9uQ29sdW1ucycsCiAgcHJvcHM6IFsnY29sdW1ucycsICd2aXNpYmxlQ29sdW1ucyddLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgaW5kZXRlcm1pbmF0ZTogZmFsc2UsCiAgICAgIGNoZWNrQWxsOiB0cnVlLAogICAgICBjaGVja2VkQ291bnRzOiB0aGlzLmNvbHVtbnMubGVuZ3RoLAogICAgICBiYWNrQ29sdW1uczogY2xvbmVEZWVwKHRoaXMuY29sdW1ucykKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgY2hlY2tlZENvdW50czogZnVuY3Rpb24gY2hlY2tlZENvdW50cyh2YWwpIHsKICAgICAgdGhpcy5jaGVja0FsbCA9IHZhbCA9PT0gdGhpcy5jb2x1bW5zLmxlbmd0aDsKICAgICAgdGhpcy5pbmRldGVybWluYXRlID0gdmFsID4gMCAmJiB2YWwgPCB0aGlzLmNvbHVtbnMubGVuZ3RoOwogICAgfSwKICAgIGNvbHVtbnM6IGZ1bmN0aW9uIGNvbHVtbnMobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgaWYgKG5ld1ZhbCAhPSBvbGRWYWwpIHsKICAgICAgICB0aGlzLmNoZWNrZWRDb3VudHMgPSBuZXdWYWwubGVuZ3RoOwogICAgICAgIHRoaXMuZm9ybWF0Q29sdW1ucyhuZXdWYWwpOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5mb3JtYXRDb2x1bW5zKHRoaXMuY29sdW1ucyk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBvbkNoZWNrQ2hhbmdlOiBmdW5jdGlvbiBvbkNoZWNrQ2hhbmdlKGUsIGNvbCkgewogICAgICBpZiAoIWNvbC52aXNpYmxlKSB7CiAgICAgICAgdGhpcy5jaGVja2VkQ291bnRzIC09IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jaGVja2VkQ291bnRzICs9IDE7CiAgICAgIH0KICAgIH0sCiAgICBmaXhDb2x1bW46IGZ1bmN0aW9uIGZpeENvbHVtbihmaXhlZCwgY29sKSB7CiAgICAgIGlmIChmaXhlZCAhPT0gY29sLmZpeGVkKSB7CiAgICAgICAgdGhpcy4kc2V0KGNvbCwgJ2ZpeGVkJywgZml4ZWQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHNldChjb2wsICdmaXhlZCcsIHVuZGVmaW5lZCk7CiAgICAgIH0KICAgIH0sCiAgICBzZXRTZWFyY2g6IGZ1bmN0aW9uIHNldFNlYXJjaChjb2wpIHsKICAgICAgdGhpcy4kc2V0KGNvbCwgJ3NlYXJjaEFibGUnLCAhY29sLnNlYXJjaEFibGUpOwoKICAgICAgaWYgKCFjb2wuc2VhcmNoQWJsZSAmJiBjb2wuc2VhcmNoKSB7CiAgICAgICAgdGhpcy5yZXNldFNlYXJjaChjb2wpOwogICAgICB9CiAgICB9LAogICAgcmVzZXRTZWFyY2g6IGZ1bmN0aW9uIHJlc2V0U2VhcmNoKGNvbCkgewogICAgICAvLyBjb2wuc2VhcmNoLnZhbHVlID0gY29sLmRhdGFUeXBlID09PSAnYm9vbGVhbicgPyBmYWxzZSA6IHVuZGVmaW5lZAogICAgICBjb2wuc2VhcmNoLnZhbHVlID0gdW5kZWZpbmVkOwogICAgICBjb2wuc2VhcmNoLmJhY2t1cCA9IHVuZGVmaW5lZDsKICAgIH0sCiAgICByZXNldENvbHVtbnM6IGZ1bmN0aW9uIHJlc2V0Q29sdW1ucygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjb2x1bW5zID0gdGhpcy5jb2x1bW5zLAogICAgICAgICAgYmFja0NvbHVtbnMgPSB0aGlzLmJhY2tDb2x1bW5zOwogICAgICB2YXIgY291bnRzID0gY29sdW1ucy5sZW5ndGg7CiAgICAgIGJhY2tDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGJhY2ssIGluZGV4KSB7CiAgICAgICAgdmFyIGNvbHVtbiA9IGNvbHVtbnNbaW5kZXhdOwogICAgICAgIGNvbHVtbi52aXNpYmxlID0gYmFjay52aXNpYmxlID09PSB1bmRlZmluZWQgfHwgYmFjay52aXNpYmxlOwoKICAgICAgICBpZiAoIWNvbHVtbi52aXNpYmxlKSB7CiAgICAgICAgICBjb3VudHMgLT0gMTsKICAgICAgICB9CgogICAgICAgIGlmIChiYWNrLmZpeGVkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGNvbHVtbi5maXhlZCA9IGJhY2suZml4ZWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLiRzZXQoY29sdW1uLCAnZml4ZWQnLCB1bmRlZmluZWQpOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuJHNldChjb2x1bW4sICdzZWFyY2hBYmxlJywgYmFjay5zZWFyY2hBYmxlKTsgLy8gY29sdW1uLnNlYXJjaEFibGUgPSBiYWNrLnNlYXJjaEFibGUKCgogICAgICAgIF90aGlzLnJlc2V0U2VhcmNoKGNvbHVtbik7CiAgICAgIH0pOwogICAgICB0aGlzLmNoZWNrZWRDb3VudHMgPSBjb3VudHM7CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLiRlbWl0KCdyZXNldCcsIHRoaXMuZ2V0Q29uZGl0aW9ucyhjb2x1bW5zKSk7CiAgICB9LAogICAgb25DaGVja0FsbENoYW5nZTogZnVuY3Rpb24gb25DaGVja0FsbENoYW5nZShlKSB7CiAgICAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgdGhpcy5jaGVja2VkQ291bnRzID0gdGhpcy5jb2x1bW5zLmxlbmd0aDsKICAgICAgICB0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sKSB7CiAgICAgICAgICByZXR1cm4gY29sLnZpc2libGUgPSB0cnVlOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY2hlY2tlZENvdW50cyA9IDA7CiAgICAgICAgdGhpcy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbCkgewogICAgICAgICAgcmV0dXJuIGNvbC52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRDb25kaXRpb25zOiBmdW5jdGlvbiBnZXRDb25kaXRpb25zKGNvbHVtbnMpIHsKICAgICAgdmFyIGNvbmRpdGlvbnMgPSB7fTsKICAgICAgY29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5zZWFyY2gudmFsdWUgIT09IHVuZGVmaW5lZCAmJiBpdGVtLnNlYXJjaC52YWx1ZSAhPT0gJycgJiYgaXRlbS5zZWFyY2gudmFsdWUgIT09IG51bGw7CiAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGNvbCkgewogICAgICAgIGNvbmRpdGlvbnNbY29sLmRhdGFJbmRleF0gPSBjb2wuc2VhcmNoLnZhbHVlOwogICAgICB9KTsKICAgICAgcmV0dXJuIGNvbmRpdGlvbnM7CiAgICB9LAogICAgZm9ybWF0Q29sdW1uczogZnVuY3Rpb24gZm9ybWF0Q29sdW1ucyhjb2x1bW5zKSB7CiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihjb2x1bW5zKSwKICAgICAgICAgIF9zdGVwOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGNvbCA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgIGlmIChjb2wudmlzaWJsZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHRoaXMuJHNldChjb2wsICd2aXNpYmxlJywgdHJ1ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFjb2wudmlzaWJsZSkgewogICAgICAgICAgICB0aGlzLmNoZWNrZWRDb3VudHMgLT0gMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AAEA;AACAA,uBADA;AAEAC,sCAFA;AAGAC,MAHA,kBAGA;AACA;AACAC,oBADA;AAEAC,0BAFA;AAGAC,oBAHA;AAIAC,wCAJA;AAKAC;AALA;AAOA,GAXA;AAYAC;AACAF,iBADA,yBACAG,GADA,EACA;AACA;AACA;AACA,KAJA;AAKAC,WALA,mBAKAC,MALA,EAKAC,MALA,EAKA;AACA;AACA;AACA;AACA;AACA;AAVA,GAZA;AAwBAC,SAxBA,qBAwBA;AACA;AACA,GA1BA;AA2BAC;AACAC,iBADA,yBACAC,CADA,EACAC,GADA,EACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAPA;AAQAC,aARA,qBAQAC,KARA,EAQAF,GARA,EAQA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAdA;AAeAG,aAfA,qBAeAH,GAfA,EAeA;AACA;;AACA;AACA;AACA;AACA,KApBA;AAqBAI,eArBA,uBAqBAJ,GArBA,EAqBA;AACA;AACAA;AACAA;AACA,KAzBA;AA0BAK,gBA1BA,0BA0BA;AAAA;;AACA;AAAA;AACA;AACAf;AACA;AACAgB;;AACA;AACAC;AACA;;AACA;AACAD;AACA,SAFA,MAEA;AACA;AACA;;AACA,0DAXA,CAYA;;;AACA;AACA,OAdA;AAeA;AACA;AACA;AACA,KA/CA;AAgDAE,oBAhDA,4BAgDAT,CAhDA,EAgDA;AACA;AACA;AACA;AAAA;AAAA;AACA,OAHA,MAGA;AACA;AACA;AAAA;AAAA;AACA;AACA,KAxDA;AAyDAU,iBAzDA,yBAyDAhB,OAzDA,EAyDA;AACA;AACAA;AAAA;AAAA,SACAiB,OADA,CACA;AACAC;AACA,OAHA;AAIA;AACA,KAhEA;AAiEAC,iBAjEA,yBAiEAnB,OAjEA,EAiEA;AAAA,iDACAA,OADA;AAAA;;AAAA;AACA;AAAA;;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AASA;AA1EA;AA3BA","names":["name","props","data","visible","indeterminate","checkAll","checkedCounts","backColumns","watch","val","columns","newVal","oldVal","created","methods","onCheckChange","e","col","fixColumn","fixed","setSearch","resetSearch","resetColumns","column","counts","onCheckAllChange","getConditions","forEach","conditions","formatColumns"],"sourceRoot":"src/components/table/advance","sources":["ActionColumns.vue"],"sourcesContent":["<template>\n  <div class=\"action-columns\" ref=\"root\">\n      <a-popover v-model=\"visible\" placement=\"bottomRight\" trigger=\"click\" :get-popup-container=\"() => $refs.root\">\n        <div slot=\"title\">\n          <a-checkbox :indeterminate=\"indeterminate\" :checked=\"checkAll\" @change=\"onCheckAllChange\" class=\"check-all\" />列展示\n          <a-button @click=\"resetColumns\" style=\"float: right\" type=\"link\" size=\"small\">重置</a-button>\n        </div>\n        <a-list style=\"width: 100%\" size=\"small\" :key=\"i\" v-for=\"(col, i) in columns\" slot=\"content\">\n          <a-list-item>\n            <a-checkbox v-model=\"col.visible\" @change=\"e => onCheckChange(e, col)\"/>\n            <template v-if=\"col.title\">\n              {{col.title}}:\n            </template>\n            <slot v-else-if=\"col.slots && col.slots.title\" :name=\"col.slots.title\"></slot>\n            <template slot=\"actions\">\n              <a-tooltip title=\"固定在列头\" :mouseEnterDelay=\"0.5\" :get-popup-container=\"() => $refs.root\">\n                <a-icon :class=\"['left', {active: col.fixed === 'left'}]\" @click=\"fixColumn('left', col)\" type=\"vertical-align-top\" />\n              </a-tooltip>\n              <a-tooltip title=\"固定在列尾\" :mouseEnterDelay=\"0.5\" :get-popup-container=\"() => $refs.root\">\n                <a-icon :class=\"['right', {active: col.fixed === 'right'}]\" @click=\"fixColumn('right', col)\" type=\"vertical-align-bottom\" />\n              </a-tooltip>\n              <a-tooltip title=\"添加搜索\" :mouseEnterDelay=\"0.5\" :get-popup-container=\"() => $refs.root\">\n                <a-icon :class=\"{active: col.searchAble}\" @click=\"setSearch(col)\" type=\"search\" />\n              </a-tooltip>\n            </template>\n          </a-list-item>\n        </a-list>\n        <a-icon class=\"action\" type=\"setting\" />\n      </a-popover>\n  </div>\n</template>\n\n<script>\n  import cloneDeep from 'lodash.clonedeep'\n\n  export default {\n    name: 'ActionColumns',\n    props: ['columns', 'visibleColumns'],\n    data() {\n      return {\n        visible: false,\n        indeterminate: false,\n        checkAll: true,\n        checkedCounts: this.columns.length,\n        backColumns: cloneDeep(this.columns)\n      }\n    },\n    watch: {\n      checkedCounts(val) {\n        this.checkAll = val === this.columns.length\n        this.indeterminate = val > 0 && val < this.columns.length\n      },\n      columns(newVal, oldVal) {\n        if (newVal != oldVal) {\n          this.checkedCounts = newVal.length\n          this.formatColumns(newVal)\n        }\n      }\n    },\n    created() {\n      this.formatColumns(this.columns)\n    },\n    methods: {\n      onCheckChange(e, col) {\n        if (!col.visible) {\n          this.checkedCounts -= 1\n        } else {\n          this.checkedCounts += 1\n        }\n      },\n      fixColumn(fixed, col) {\n        if (fixed !== col.fixed) {\n          this.$set(col, 'fixed', fixed)\n        } else {\n          this.$set(col, 'fixed', undefined)\n        }\n      },\n      setSearch(col) {\n        this.$set(col, 'searchAble', !col.searchAble)\n        if (!col.searchAble && col.search) {\n          this.resetSearch(col)\n        }\n      },\n      resetSearch(col) {\n        // col.search.value = col.dataType === 'boolean' ? false : undefined\n        col.search.value = undefined\n        col.search.backup = undefined\n      },\n      resetColumns() {\n        const {columns, backColumns} = this\n        let counts = columns.length\n        backColumns.forEach((back, index) => {\n          const column = columns[index]\n          column.visible = back.visible === undefined || back.visible\n          if (!column.visible) {\n            counts -= 1\n          }\n          if (back.fixed !== undefined) {\n            column.fixed = back.fixed\n          } else {\n            this.$set(column, 'fixed', undefined)\n          }\n          this.$set(column, 'searchAble', back.searchAble)\n          // column.searchAble = back.searchAble\n          this.resetSearch(column)\n        })\n        this.checkedCounts = counts\n        this.visible = false\n        this.$emit('reset', this.getConditions(columns))\n      },\n      onCheckAllChange(e) {\n        if (e.target.checked) {\n          this.checkedCounts = this.columns.length\n          this.columns.forEach(col => col.visible = true)\n        } else {\n          this.checkedCounts = 0\n          this.columns.forEach(col => col.visible = false)\n        }\n      },\n      getConditions(columns) {\n        const conditions = {}\n        columns.filter(item => item.search.value !== undefined && item.search.value !== '' && item.search.value !== null)\n          .forEach(col => {\n            conditions[col.dataIndex] = col.search.value\n          })\n        return conditions\n      },\n      formatColumns(columns) {\n        for (let col of columns) {\n          if (col.visible === undefined) {\n            this.$set(col, 'visible', true)\n          }\n          if (!col.visible) {\n            this.checkedCounts -= 1\n          }\n        }\n      }\n    }\n  }\n</script>\n\n<style scoped lang=\"less\">\n.action-columns{\n  display: inline-block;\n  .check-all{\n    margin-right: 8px;\n  }\n  .left,.right{\n    transform: rotate(-90deg);\n  }\n  .active{\n    color: @primary-color;\n  }\n}\n</style>"]}]}