{"remainingRequest":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\src\\components\\table\\advance\\ActionColumns.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\src\\components\\table\\advance\\ActionColumns.vue","mtime":1637637094000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\maxzh\\OneDrive\\桌面\\vue-antd-admin-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjbG9uZURlZXAgZnJvbSAnbG9kYXNoLmNsb25lZGVlcCcKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQWN0aW9uQ29sdW1ucycsCiAgcHJvcHM6IFsnY29sdW1ucycsICd2aXNpYmxlQ29sdW1ucyddLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgaW5kZXRlcm1pbmF0ZTogZmFsc2UsCiAgICAgIGNoZWNrQWxsOiB0cnVlLAogICAgICBjaGVja2VkQ291bnRzOiB0aGlzLmNvbHVtbnMubGVuZ3RoLAogICAgICBiYWNrQ29sdW1uczogY2xvbmVEZWVwKHRoaXMuY29sdW1ucykKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBjaGVja2VkQ291bnRzKHZhbCkgewogICAgICB0aGlzLmNoZWNrQWxsID0gdmFsID09PSB0aGlzLmNvbHVtbnMubGVuZ3RoCiAgICAgIHRoaXMuaW5kZXRlcm1pbmF0ZSA9IHZhbCA+IDAgJiYgdmFsIDwgdGhpcy5jb2x1bW5zLmxlbmd0aAogICAgfSwKICAgIGNvbHVtbnMobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgaWYgKG5ld1ZhbCAhPSBvbGRWYWwpIHsKICAgICAgICB0aGlzLmNoZWNrZWRDb3VudHMgPSBuZXdWYWwubGVuZ3RoCiAgICAgICAgdGhpcy5mb3JtYXRDb2x1bW5zKG5ld1ZhbCkKICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZm9ybWF0Q29sdW1ucyh0aGlzLmNvbHVtbnMpCiAgfSwKICBtZXRob2RzOiB7CiAgICBvbkNoZWNrQ2hhbmdlKGUsIGNvbCkgewogICAgICBpZiAoIWNvbC52aXNpYmxlKSB7CiAgICAgICAgdGhpcy5jaGVja2VkQ291bnRzIC09IDEKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNoZWNrZWRDb3VudHMgKz0gMQogICAgICB9CiAgICB9LAogICAgZml4Q29sdW1uKGZpeGVkLCBjb2wpIHsKICAgICAgaWYgKGZpeGVkICE9PSBjb2wuZml4ZWQpIHsKICAgICAgICB0aGlzLiRzZXQoY29sLCAnZml4ZWQnLCBmaXhlZCkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRzZXQoY29sLCAnZml4ZWQnLCB1bmRlZmluZWQpCiAgICAgIH0KICAgIH0sCiAgICBzZXRTZWFyY2goY29sKSB7CiAgICAgIHRoaXMuJHNldChjb2wsICdzZWFyY2hBYmxlJywgIWNvbC5zZWFyY2hBYmxlKQogICAgICBpZiAoIWNvbC5zZWFyY2hBYmxlICYmIGNvbC5zZWFyY2gpIHsKICAgICAgICB0aGlzLnJlc2V0U2VhcmNoKGNvbCkKICAgICAgfQogICAgfSwKICAgIHJlc2V0U2VhcmNoKGNvbCkgewogICAgICAvLyBjb2wuc2VhcmNoLnZhbHVlID0gY29sLmRhdGFUeXBlID09PSAnYm9vbGVhbicgPyBmYWxzZSA6IHVuZGVmaW5lZAogICAgICBjb2wuc2VhcmNoLnZhbHVlID0gdW5kZWZpbmVkCiAgICAgIGNvbC5zZWFyY2guYmFja3VwID0gdW5kZWZpbmVkCiAgICB9LAogICAgcmVzZXRDb2x1bW5zKCkgewogICAgICBjb25zdCB7Y29sdW1ucywgYmFja0NvbHVtbnN9ID0gdGhpcwogICAgICBsZXQgY291bnRzID0gY29sdW1ucy5sZW5ndGgKICAgICAgYmFja0NvbHVtbnMuZm9yRWFjaCgoYmFjaywgaW5kZXgpID0+IHsKICAgICAgICBjb25zdCBjb2x1bW4gPSBjb2x1bW5zW2luZGV4XQogICAgICAgIGNvbHVtbi52aXNpYmxlID0gYmFjay52aXNpYmxlID09PSB1bmRlZmluZWQgfHwgYmFjay52aXNpYmxlCiAgICAgICAgaWYgKCFjb2x1bW4udmlzaWJsZSkgewogICAgICAgICAgY291bnRzIC09IDEKICAgICAgICB9CiAgICAgICAgaWYgKGJhY2suZml4ZWQgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgY29sdW1uLmZpeGVkID0gYmFjay5maXhlZAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRzZXQoY29sdW1uLCAnZml4ZWQnLCB1bmRlZmluZWQpCiAgICAgICAgfQogICAgICAgIHRoaXMuJHNldChjb2x1bW4sICdzZWFyY2hBYmxlJywgYmFjay5zZWFyY2hBYmxlKQogICAgICAgIC8vIGNvbHVtbi5zZWFyY2hBYmxlID0gYmFjay5zZWFyY2hBYmxlCiAgICAgICAgdGhpcy5yZXNldFNlYXJjaChjb2x1bW4pCiAgICAgIH0pCiAgICAgIHRoaXMuY2hlY2tlZENvdW50cyA9IGNvdW50cwogICAgICB0aGlzLnZpc2libGUgPSBmYWxzZQogICAgICB0aGlzLiRlbWl0KCdyZXNldCcsIHRoaXMuZ2V0Q29uZGl0aW9ucyhjb2x1bW5zKSkKICAgIH0sCiAgICBvbkNoZWNrQWxsQ2hhbmdlKGUpIHsKICAgICAgaWYgKGUudGFyZ2V0LmNoZWNrZWQpIHsKICAgICAgICB0aGlzLmNoZWNrZWRDb3VudHMgPSB0aGlzLmNvbHVtbnMubGVuZ3RoCiAgICAgICAgdGhpcy5jb2x1bW5zLmZvckVhY2goY29sID0+IGNvbC52aXNpYmxlID0gdHJ1ZSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNoZWNrZWRDb3VudHMgPSAwCiAgICAgICAgdGhpcy5jb2x1bW5zLmZvckVhY2goY29sID0+IGNvbC52aXNpYmxlID0gZmFsc2UpCiAgICAgIH0KICAgIH0sCiAgICBnZXRDb25kaXRpb25zKGNvbHVtbnMpIHsKICAgICAgY29uc3QgY29uZGl0aW9ucyA9IHt9CiAgICAgIGNvbHVtbnMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5zZWFyY2gudmFsdWUgIT09IHVuZGVmaW5lZCAmJiBpdGVtLnNlYXJjaC52YWx1ZSAhPT0gJycgJiYgaXRlbS5zZWFyY2gudmFsdWUgIT09IG51bGwpCiAgICAgICAgLmZvckVhY2goY29sID0+IHsKICAgICAgICAgIGNvbmRpdGlvbnNbY29sLmRhdGFJbmRleF0gPSBjb2wuc2VhcmNoLnZhbHVlCiAgICAgICAgfSkKICAgICAgcmV0dXJuIGNvbmRpdGlvbnMKICAgIH0sCiAgICBmb3JtYXRDb2x1bW5zKGNvbHVtbnMpIHsKICAgICAgZm9yIChsZXQgY29sIG9mIGNvbHVtbnMpIHsKICAgICAgICBpZiAoY29sLnZpc2libGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy4kc2V0KGNvbCwgJ3Zpc2libGUnLCB0cnVlKQogICAgICAgIH0KICAgICAgICBpZiAoIWNvbC52aXNpYmxlKSB7CiAgICAgICAgICB0aGlzLmNoZWNrZWRDb3VudHMgLT0gMQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["ActionColumns.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ActionColumns.vue","sourceRoot":"src/components/table/advance","sourcesContent":["<template>\n  <div class=\"action-columns\" ref=\"root\">\n      <a-popover v-model=\"visible\" placement=\"bottomRight\" trigger=\"click\" :get-popup-container=\"() => $refs.root\">\n        <div slot=\"title\">\n          <a-checkbox :indeterminate=\"indeterminate\" :checked=\"checkAll\" @change=\"onCheckAllChange\" class=\"check-all\" />列展示\n          <a-button @click=\"resetColumns\" style=\"float: right\" type=\"link\" size=\"small\">重置</a-button>\n        </div>\n        <a-list style=\"width: 100%\" size=\"small\" :key=\"i\" v-for=\"(col, i) in columns\" slot=\"content\">\n          <a-list-item>\n            <a-checkbox v-model=\"col.visible\" @change=\"e => onCheckChange(e, col)\"/>\n            <template v-if=\"col.title\">\n              {{col.title}}:\n            </template>\n            <slot v-else-if=\"col.slots && col.slots.title\" :name=\"col.slots.title\"></slot>\n            <template slot=\"actions\">\n              <a-tooltip title=\"固定在列头\" :mouseEnterDelay=\"0.5\" :get-popup-container=\"() => $refs.root\">\n                <a-icon :class=\"['left', {active: col.fixed === 'left'}]\" @click=\"fixColumn('left', col)\" type=\"vertical-align-top\" />\n              </a-tooltip>\n              <a-tooltip title=\"固定在列尾\" :mouseEnterDelay=\"0.5\" :get-popup-container=\"() => $refs.root\">\n                <a-icon :class=\"['right', {active: col.fixed === 'right'}]\" @click=\"fixColumn('right', col)\" type=\"vertical-align-bottom\" />\n              </a-tooltip>\n              <a-tooltip title=\"添加搜索\" :mouseEnterDelay=\"0.5\" :get-popup-container=\"() => $refs.root\">\n                <a-icon :class=\"{active: col.searchAble}\" @click=\"setSearch(col)\" type=\"search\" />\n              </a-tooltip>\n            </template>\n          </a-list-item>\n        </a-list>\n        <a-icon class=\"action\" type=\"setting\" />\n      </a-popover>\n  </div>\n</template>\n\n<script>\n  import cloneDeep from 'lodash.clonedeep'\n\n  export default {\n    name: 'ActionColumns',\n    props: ['columns', 'visibleColumns'],\n    data() {\n      return {\n        visible: false,\n        indeterminate: false,\n        checkAll: true,\n        checkedCounts: this.columns.length,\n        backColumns: cloneDeep(this.columns)\n      }\n    },\n    watch: {\n      checkedCounts(val) {\n        this.checkAll = val === this.columns.length\n        this.indeterminate = val > 0 && val < this.columns.length\n      },\n      columns(newVal, oldVal) {\n        if (newVal != oldVal) {\n          this.checkedCounts = newVal.length\n          this.formatColumns(newVal)\n        }\n      }\n    },\n    created() {\n      this.formatColumns(this.columns)\n    },\n    methods: {\n      onCheckChange(e, col) {\n        if (!col.visible) {\n          this.checkedCounts -= 1\n        } else {\n          this.checkedCounts += 1\n        }\n      },\n      fixColumn(fixed, col) {\n        if (fixed !== col.fixed) {\n          this.$set(col, 'fixed', fixed)\n        } else {\n          this.$set(col, 'fixed', undefined)\n        }\n      },\n      setSearch(col) {\n        this.$set(col, 'searchAble', !col.searchAble)\n        if (!col.searchAble && col.search) {\n          this.resetSearch(col)\n        }\n      },\n      resetSearch(col) {\n        // col.search.value = col.dataType === 'boolean' ? false : undefined\n        col.search.value = undefined\n        col.search.backup = undefined\n      },\n      resetColumns() {\n        const {columns, backColumns} = this\n        let counts = columns.length\n        backColumns.forEach((back, index) => {\n          const column = columns[index]\n          column.visible = back.visible === undefined || back.visible\n          if (!column.visible) {\n            counts -= 1\n          }\n          if (back.fixed !== undefined) {\n            column.fixed = back.fixed\n          } else {\n            this.$set(column, 'fixed', undefined)\n          }\n          this.$set(column, 'searchAble', back.searchAble)\n          // column.searchAble = back.searchAble\n          this.resetSearch(column)\n        })\n        this.checkedCounts = counts\n        this.visible = false\n        this.$emit('reset', this.getConditions(columns))\n      },\n      onCheckAllChange(e) {\n        if (e.target.checked) {\n          this.checkedCounts = this.columns.length\n          this.columns.forEach(col => col.visible = true)\n        } else {\n          this.checkedCounts = 0\n          this.columns.forEach(col => col.visible = false)\n        }\n      },\n      getConditions(columns) {\n        const conditions = {}\n        columns.filter(item => item.search.value !== undefined && item.search.value !== '' && item.search.value !== null)\n          .forEach(col => {\n            conditions[col.dataIndex] = col.search.value\n          })\n        return conditions\n      },\n      formatColumns(columns) {\n        for (let col of columns) {\n          if (col.visible === undefined) {\n            this.$set(col, 'visible', true)\n          }\n          if (!col.visible) {\n            this.checkedCounts -= 1\n          }\n        }\n      }\n    }\n  }\n</script>\n\n<style scoped lang=\"less\">\n.action-columns{\n  display: inline-block;\n  .check-all{\n    margin-right: 8px;\n  }\n  .left,.right{\n    transform: rotate(-90deg);\n  }\n  .active{\n    color: @primary-color;\n  }\n}\n</style>"]}]}